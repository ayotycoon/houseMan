import{j as e,x as $,P as Y,y as R,z as Z,A as q,D as P,F as ee,H as se,J as te,K as A,N as re,O as ne,Q as oe,R as I,U as y,V as z,B as k,I as N,G as ae,W as ie}from"./index-hK64BZii.js";import"./vendor-utils-D56E7WW6.js";import{C as ce}from"./check-mYiDG6Yj.js";import{r as l,j as le}from"./vendor-core-C2O2dLVs.js";import{u as de,F as ue,a as L,b as B,c as T,d as O,e as M}from"./form-hcR2V99M.js";import"./vendor-ui-Bj3frcKa.js";var S="Checkbox",[me,Ie]=$(S),[xe,_]=me(S);function he(r){const{__scopeCheckbox:a,checked:s,children:x,defaultChecked:n,disabled:t,form:p,name:f,onCheckedChange:d,required:u,value:b="on",internal_do_not_use_render:o}=r,[h,i]=Z({prop:s,defaultProp:n??!1,onChange:d,caller:S}),[g,C]=l.useState(null),[v,c]=l.useState(null),m=l.useRef(!1),w=g?!!p||!!g.closest("form"):!0,E={checked:h,disabled:t,setChecked:i,control:g,setControl:C,name:f,form:p,value:b,hasConsumerStoppedPropagationRef:m,required:u,defaultChecked:j(n)?!1:n,isFormControl:w,bubbleInput:v,setBubbleInput:c};return e.jsx(xe,{scope:a,...E,children:pe(o)?o(E):x})}var D="CheckboxTrigger",G=l.forwardRef(({__scopeCheckbox:r,onKeyDown:a,onClick:s,...x},n)=>{const{control:t,value:p,disabled:f,checked:d,required:u,setControl:b,setChecked:o,hasConsumerStoppedPropagationRef:h,isFormControl:i,bubbleInput:g}=_(D,r),C=q(n,b),v=l.useRef(d);return l.useEffect(()=>{const c=t?.form;if(c){const m=()=>o(v.current);return c.addEventListener("reset",m),()=>c.removeEventListener("reset",m)}},[t,o]),e.jsx(R.button,{type:"button",role:"checkbox","aria-checked":j(d)?"mixed":d,"aria-required":u,"data-state":V(d),"data-disabled":f?"":void 0,disabled:f,value:p,...x,ref:C,onKeyDown:P(a,c=>{c.key==="Enter"&&c.preventDefault()}),onClick:P(s,c=>{o(m=>j(m)?!0:!m),g&&i&&(h.current=c.isPropagationStopped(),h.current||c.stopPropagation())})})});G.displayName=D;var H=l.forwardRef((r,a)=>{const{__scopeCheckbox:s,name:x,checked:n,defaultChecked:t,required:p,disabled:f,value:d,onCheckedChange:u,form:b,...o}=r;return e.jsx(he,{__scopeCheckbox:s,checked:n,defaultChecked:t,disabled:f,required:p,onCheckedChange:u,name:x,form:b,value:d,internal_do_not_use_render:({isFormControl:h})=>e.jsxs(e.Fragment,{children:[e.jsx(G,{...o,ref:a,__scopeCheckbox:s}),h&&e.jsx(Q,{__scopeCheckbox:s})]})})});H.displayName=S;var U="CheckboxIndicator",K=l.forwardRef((r,a)=>{const{__scopeCheckbox:s,forceMount:x,...n}=r,t=_(U,s);return e.jsx(Y,{present:x||j(t.checked)||t.checked===!0,children:e.jsx(R.span,{"data-state":V(t.checked),"data-disabled":t.disabled?"":void 0,...n,ref:a,style:{pointerEvents:"none",...r.style}})})});K.displayName=U;var W="CheckboxBubbleInput",Q=l.forwardRef(({__scopeCheckbox:r,...a},s)=>{const{control:x,hasConsumerStoppedPropagationRef:n,checked:t,defaultChecked:p,required:f,disabled:d,name:u,value:b,form:o,bubbleInput:h,setBubbleInput:i}=_(W,r),g=q(s,i),C=ee(t),v=se(x);l.useEffect(()=>{const m=h;if(!m)return;const w=window.HTMLInputElement.prototype,F=Object.getOwnPropertyDescriptor(w,"checked").set,X=!n.current;if(C!==t&&F){const J=new Event("click",{bubbles:X});m.indeterminate=j(t),F.call(m,j(t)?!1:t),m.dispatchEvent(J)}},[h,C,t,n]);const c=l.useRef(j(t)?!1:t);return e.jsx(R.input,{type:"checkbox","aria-hidden":!0,defaultChecked:p??c.current,required:f,disabled:d,name:u,value:b,form:o,...a,tabIndex:-1,ref:g,style:{...a.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Q.displayName=W;function pe(r){return typeof r=="function"}function j(r){return r==="indeterminate"}function V(r){return j(r)?"indeterminate":r?"checked":"unchecked"}const fe=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],be=te("loader-circle",fe);function ge({className:r,...a}){return e.jsx(H,{"data-slot":"checkbox",className:A("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",r),...a,children:e.jsx(K,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(ce,{className:"size-3.5"})})})}function Se({className:r,...a}){const{t:s}=re(),[x,n]=l.useState(!1),[t,p]=l.useState(!0),f=le(),{loginState:d,setLoginState:u}=ne(),b=oe(),o=de({defaultValues:{username:I[0].username,password:I[0].password}});if(d!==y.LOGIN)return null;const h=async i=>{n(!0);try{await b(i),f(ae.defaultRoute,{replace:!0}),ie.success("Sign in success!",{closeButton:!0})}finally{n(!1)}};return e.jsx("div",{className:A("flex flex-col gap-6",r),children:e.jsx(ue,{...o,...a,children:e.jsxs("form",{onSubmit:o.handleSubmit(h),className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold",children:s("sys.login.signInFormTitle")}),e.jsx("p",{className:"text-balance text-sm text-muted-foreground",children:s("sys.login.signInFormDescription")})]}),e.jsx(L,{control:o.control,name:"username",rules:{required:s("sys.login.accountPlaceholder")},render:({field:i})=>e.jsxs(B,{children:[e.jsx(T,{children:s("sys.login.userName")}),e.jsx(O,{children:e.jsx(z,{placeholder:I.map(g=>g.username).join("/"),...i})}),e.jsx(M,{})]})}),e.jsx(L,{control:o.control,name:"password",rules:{required:s("sys.login.passwordPlaceholder")},render:({field:i})=>e.jsxs(B,{children:[e.jsx(T,{children:s("sys.login.password")}),e.jsx(O,{children:e.jsx(z,{type:"password",placeholder:I[0].password,...i,suppressHydrationWarning:!0})}),e.jsx(M,{})]})}),e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ge,{id:"remember",checked:t,onCheckedChange:i=>p(i==="indeterminate"?!1:i)}),e.jsx("label",{htmlFor:"remember",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:s("sys.login.rememberMe")})]}),e.jsx(k,{variant:"link",onClick:()=>u(y.RESET_PASSWORD),size:"sm",children:s("sys.login.forgetPassword")})]}),e.jsxs(k,{type:"submit",className:"w-full",children:[x&&e.jsx(be,{className:"animate-spin mr-2"}),s("sys.login.loginButton")]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs(k,{variant:"outline",className:"w-full",onClick:()=>u(y.MOBILE),children:[e.jsx(N,{icon:"uil:mobile-android",size:20}),s("sys.login.mobileSignInFormTitle")]}),e.jsxs(k,{variant:"outline",className:"w-full",onClick:()=>u(y.QR_CODE),children:[e.jsx(N,{icon:"uil:qrcode-scan",size:20}),s("sys.login.qrSignInFormTitle")]})]}),e.jsx("div",{className:"relative text-center text-sm after:absolute after:inset-0 after:top-1/2 after:z-0 after:flex after:items-center after:border-t after:border-border",children:e.jsx("span",{className:"relative z-10 bg-background px-2 text-muted-foreground",children:s("sys.login.otherSignIn")})}),e.jsxs("div",{className:"flex cursor-pointer justify-around text-2xl",children:[e.jsx(k,{variant:"ghost",size:"icon",children:e.jsx(N,{icon:"mdi:github",size:24})}),e.jsx(k,{variant:"ghost",size:"icon",children:e.jsx(N,{icon:"mdi:wechat",size:24})}),e.jsx(k,{variant:"ghost",size:"icon",children:e.jsx(N,{icon:"ant-design:google-circle-filled",size:24})})]}),e.jsxs("div",{className:"text-center text-sm",children:[s("sys.login.noAccount"),e.jsx(k,{variant:"link",className:"px-1",onClick:()=>u(y.REGISTER),children:s("sys.login.signUpFormTitle")})]})]})})})}export{Se as LoginForm,Se as default};
